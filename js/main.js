var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(b.get||b.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,c,b,e){if(c){b=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var f=a[e];f in b||(b[f]={});b=b[f]}a=a[a.length-1];e=b[a];c=c(e);c!=e&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Number.isFinite",function(a){return a?a:function(a){return"number"!==typeof a?!1:!isNaN(a)&&Infinity!==a&&-Infinity!==a}},"es6-impl","es3");
$jscomp.polyfill("Number.isInteger",function(a){return a?a:function(a){return Number.isFinite(a)?a===Math.floor(a):!1}},"es6-impl","es3");$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var e=a.length,f=0;f<e;f++){var d=a[f];if(c.call(b,d,f,a))return{i:f,v:d}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6-impl","es3");
(function(a){if("function"===typeof define&&define.amd)define(a);else if("object"===typeof exports)module.exports=a();else{var c=window.Cookies,b=window.Cookies=a();b.noConflict=function(){window.Cookies=c;return b}}})(function(){function a(){for(var b=0,a={};b<arguments.length;b++){var c=arguments[b],d;for(d in c)a[d]=c[d]}return a}function c(b){function e(c,d,g){var f;if("undefined"!==typeof document){if(1<arguments.length){g=a({path:"/"},e.defaults,g);if("number"===typeof g.expires){var h=new Date;
h.setMilliseconds(h.getMilliseconds()+864E5*g.expires);g.expires=h}try{f=JSON.stringify(d),/^[\{\[]/.test(f)&&(d=f)}catch(r){}d=b.write?b.write(d,c):encodeURIComponent(String(d)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent);c=encodeURIComponent(String(c));c=c.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent);c=c.replace(/[\(\)]/g,escape);return document.cookie=[c,"=",d,g.expires&&"; expires="+g.expires.toUTCString(),g.path&&"; path="+g.path,g.domain&&
"; domain="+g.domain,g.secure?"; secure":""].join("")}c||(f={});for(var h=document.cookie?document.cookie.split("; "):[],n=/(%[0-9A-Z]{2})+/g,l=0;l<h.length;l++){var p=h[l].split("="),k=p.slice(1).join("=");'"'===k.charAt(0)&&(k=k.slice(1,-1));try{var q=p[0].replace(n,decodeURIComponent),k=b.read?b.read(k,q):b(k,q)||k.replace(n,decodeURIComponent);if(this.json)try{k=JSON.parse(k)}catch(r){}if(c===q){f=k;break}c||(f[q]=k)}catch(r){}}return f}}e.set=e;e.get=function(b){return e(b)};e.getJSON=function(){return e.apply({json:!0},
[].slice.call(arguments))};e.defaults={};e.remove=function(b,c){e(b,"",a(c,{expires:-1}))};e.withConverter=c;return e}return c(function(){})});var SCALE_SEMITONES_NUMBER=12,MAX_HALF_STEP=11,MIN_HALF_STEP=-11,MAX_STRINGS_NUMBER=12,MIN_STRINGS_NUMBER=3,MAX_ITEMS_NUMBER=5,FRETS_NUMBER=24,DEFAULT_METR_BEATS=4,DEFAULT_METR_BEAT_VAL=4,DEFAULT_METR_VOLUME=50,DEFAULT_METR_TEMPO=120,MIN_BEATS=1,MAX_BEATS=16,MIN_BEAT_VAL=1,MAX_BEAT_VAL=32,MIN_TEMPO=40,MAX_TEMPO=320,DEFAULT_SCALE_OPTIONS_EXPIRE_DAYS=30,DEFAULT_NOTES_SHOW_PATTERN=[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],DEFAULT_TRIADS_SHOW_PATTERN=[!0,!1,!0,!1,!0,!1,!1,!1,!1,!1,!1,!1],NOTES="C C# D D# E F F# G G# A A# B".split(" "),
DEFAULT_SCALE_SEMITONES=[2,2,1,2,2,2,1],DEFAULT_STRING_TUNES="E B G D A E B F# C# G# D# A#".split(" "),DEFAULT_SCALE_NOTES="CDEFGAB".split(""),SCALES={major:[2,2,1,2,2,2,1],aeolian:[2,2,1,2,2,2,1],minor:[2,1,2,2,1,2,2],ionian:[2,1,2,2,1,2,2],harmonic_min:[2,1,2,2,1,3,1],chromatic:[1,1,1,1,1,1,1,1,1,1,1,1],dorian:[2,1,2,2,2,1,2],phrygian:[1,2,2,2,1,2,2],lydian:[2,2,2,1,2,2,1],myxolydian:[2,2,1,2,2,1,2],locrian:[1,2,2,1,2,2,2],melodic_min:[2,1,2,2,2,2,1],alt_dom:[1,2,1,2,2,2,2],sup_locrian:[1,2,1,2,
2,2,2],dim_whole_tone:[1,2,1,2,2,2,2],alt_scale:[1,2,1,2,2,2,2],blues_min_hex:[3,2,1,1,3,2],blues_pent:[3,2,1,4,2],blues:[3,2,1,1,3,1,1],major_pent:[2,2,3,2,3],suspended_pent:[2,3,2,3,2],dorian_pent:[2,3,2,3,2],phrygian_pent:[3,2,3,2,2],myxolydian_pent:[2,3,2,2,3],aeolian_pent:[3,2,2,3,2],minor_pent:[3,2,2,3,2],major_beb:[2,2,1,2,1,1,2,1],minor_beb:[2,1,1,1,2,2,1,2],dom_beb:[2,2,1,2,2,1,1,1],dorian_beb:[2,1,1,1,2,2,1,2],whole_tone:[2,2,2,2,2,2],whole_half_tone:[2,1,2,1,2,1,2,1],half_whole_tone:[1,
2,1,2,1,2,1,2],dim:[2,1,2,1,2,1,2,1],dom_dim:[1,2,1,2,1,2,1,2],symm_dim:[1,2,1,2,1,2,1,2],spanish:[1,2,2,2,1,2,2],acoustic:[2,2,2,1,2,1,2],bartok:[2,2,2,1,2,1,2]},TUNINGS={standart_e:"E B G D A E B F# C# G# D# A#".split(" "),standart_e_bass:["G","D","A","E","B"],standart_e_bass_6:"CGDAEB".split(""),drop_d_6:"E B G D A D B F# C# G# D# A#".split(" "),drop_a_7:"E B G D A E A F# C# G# D# A#".split(" "),drop_e_8:"E B G D A E B E C# G# D# A#".split(" ")},CUSTOM_TUNING_VALUE="custom",ITEM_CLASS="item_block",
STRING_NUMBER_CLASS="strings_number",SCALE_SELECT_CLASS="scale_select",FRETBOARD_CLASS="fretboard",HOR_FRET_CLASS="fret_hor",NULL_VER_FRET_CLASS="fret_null",VER_FRET_CLASS="fret_ver",VER_FRET_INNER_CLASS="fret_ver_inner",FRET_HOVER_CLASS="fret_ver_hover",FRET_HOVER_ACTIVE_CENTER_CLASS="fret_ver_hover_active_center",FRET_HOVER_ACTIVE_START_CLASS="fret_ver_hover_active_start",FRET_HOVER_ACTIVE_END_CLASS="fret_ver_hover_active_end",NOTE_CLASS="note",NORMAL_NOTE_CLASS="normal_note",HIGHLIGHTED_NOTE_CLASS=
"highlighted_note",TRANSPARENT_NOTE_CLASS="transparent_note",HIDDEN_NOTE_CLASS="hidden_note",STRINGS_OPTIONS_BLOCK_CLASS="strings_options_block",STRING_TUNE_BLOCK_CLASS="string_tune",STRING_TUNE_SELECT_CLASS="string_tune_select",LEFT_ARROW_CLASS="left_arrow",RIGHT_ARROW_CLASS="right_arrow",HALF_STEP_BLOCK_CLASS="half_step_block",HALF_STEP_SELECT_CLASS="half_step_select",TUNING_SELECT_CLASS="tuning_select",ROOT_NOTE_CLASS="root_note",SELECTED_TEXT_CLASS="selected_text",SCALE_NOTES_BLOCK_CLASS="scale_notes_and_semitones_block",
SCALE_NOTES_CLASS="scale_notes",SCALE_NOTE_CLASS="scale_note",SCALE_NOTE_TEXT_CLASS="scale_note_text",ADD_STRING_BTN_CLASS="add_string",DEL_STRING_BTN_CLASS="delete_string",CLOSE_BTN_CLASS="close_btn",SET_DEFAULT_BTN_CLASS="set_default_btn",TRIADS_CHECKBOX_CLASS="triads_checkbox",TRIADS_CHECKBOX_EMPTY_CLASS="triads_checkbox_empty",METRONOME_DISABLED_ID="metronome_disabled_block",ADD_NEW_ITEM_BTN_ID="add_new_item_btn",METR_PLAY_BTN_ID="metronome_play_btn",METR_STOP_BTN_ID="metronome_stop_btn",METR_VOLUME_RANGE_ID=
"metronome_volume_range",METR_TEMPO_RANGE_ID="metronome_tempo_range",METR_TEMPO_INPUT_ID="metronome_tempo_input",METR_TEMPO_LEFT_ARROW_ID="metronome_tempo_left_arrow",METR_TEMPO_RIGHT_ARROW_ID="metronome_tempo_right_arrow",METR_BEATS_SELECT_ID="metronome_beats_select",METR_BEATS_LEFT_ARROW_ID="metronome_beats_left_arrow",METR_BEATS_RIGHT_ARROW_ID="metronome_beats_right_arrow",METR_BEAT_VAL_SELECT_ID="metronome_beat_val_select",METR_BEAT_VAL_LEFT_ARROW_ID="metronome_beat_val_left_arrow",METR_BEAT_VAL_RIGHT_ARROW_ID=
"metronome_beat_val_right_arrow",WRONG_SEMITONE_NUMBER_MSG="Wrong sum of semitones, must be equal to "+SCALE_SEMITONES_NUMBER,WRONG_ROOT_NOTE_MSG="Wrong root note",WRONG_NOTE_MSG="Wrong note",WRONG_SCALE_NAME_MSG="Wrong scale name (value)",WRONG_STRING_TUNE_NOTE_MSG="Wrong string tune note",WRONG_TUNING_NAME="Wrong tuning name (value)",PARAMS_ATOB_ERROR_MSG="GET parameter cannot be decoded",SCALE_NOTES_TMPL=doT.template($("#scale_notes_tmpl").html()),STRING_VER_FRET_TMPL=doT.template($("#string_ver_fret_tmpl").html()),
STRING_FRET_TMPL=doT.template($("#string_hor_fret_tmpl").html()),STRING_FRET_MARK_TMPL=doT.template($("#fretboard_single_mark").html()),STRING_DOUBLE_FRET_MARK_TMPL=doT.template($("#fretboard_double_mark").html()),FRET_DOT_TMPL=doT.template($("#fret_dot_tmpl").html()),FRET_DOUBLE_DOT_TMPL=doT.template($("#fret_double_dot_tmpl").html()),STRING_TUNE_BLOCK_TMPL=doT.template($("#string_tune_block_tmpl").html()),SCALES_ITEM_BLOCK_TMPL=doT.template($("#scales_item_tmpl").html());function isCorrectNote(a){if("string"!==typeof a)return!1;var c=!1;0<=NOTES.indexOf(a.toUpperCase())?c=!0:console.log(a+": "+WRONG_NOTE_MSG);return c}function isCorrectSemitonesSum(a){if("object"!==typeof a||!Array.isArray(a))return!1;for(var c=!1,b=0,e=0;e<a.length;e++)b+=a[e];b==SCALE_SEMITONES_NUMBER?c=!0:console.log(a+": "+WRONG_SEMITONE_NUMBER_MSG);return c}
function isCorrectScale(a){if("string"!==typeof a)return!1;var c=!1,b=SCALES[a];void 0!==b?c=isCorrectSemitonesSum(b):console.log(a+": "+WRONG_SCALE_NAME_MSG);return c}function isCorrectTuningNotes(a){if("object"!==typeof a||!Array.isArray(a))return!1;for(var c=!1,b=0;b<a.length&&(c=isCorrectNote(a[b]),c);b++);return c}
function isCorrectTuning(a){if("string"!==typeof a)return!1;var c=!1;if(a==CUSTOM_TUNING_VALUE)c=!0;else{var b=TUNINGS[a];void 0!==b?c=isCorrectTuningNotes(b):console.log(a+": "+WRONG_TUNING_NAME)}return c}function isCorrectHalfStep(a){return Number.isInteger(a)&&+a>=MIN_HALF_STEP&&+a<=MAX_HALF_STEP}function isCorrectStringsNumber(a){return Number.isInteger(a)&&+a>=MIN_STRINGS_NUMBER&&+a<=MAX_STRINGS_NUMBER}
function isCorrectNotesShowPattern(a){var c="object"===typeof a&&Array.isArray(a);if(!c)return!1;var b=a.every(function(b){return"boolean"===typeof b});if(!b)return!1;a=12==a.length;return c&&b&&a}function isCorrectBoxFret(a){return Number.isInteger(a)&&-1<=a&&a<=FRETS_NUMBER}function getScaleSemitones(a){a=a.toLowerCase();var c=DEFAULT_SCALE_SEMITONES;isCorrectScale(a)&&(c=SCALES[a]);return c}
function getTuneNotes(a){a=a.toLowerCase();var c=DEFAULT_STRING_TUNES;isCorrectTuning(a)&&(c=TUNINGS[a].slice());return c}function prevNote(a){resultNote="C";isCorrectNote(a)&&(a=NOTES.indexOf(a),a--,0>a&&(a=NOTES.length-1),resultNote=NOTES[a]);return resultNote}function nextNote(a){resultNote="C";isCorrectNote(a)&&(a=NOTES.indexOf(a),a++,a==NOTES.length&&(a=0),resultNote=NOTES[a]);return resultNote}
function nextNoteAfterSemiTones(a,c){var b=a;if(0<c)for(var e=0;e<c;e++)b=nextNote(b);else for(e=0;e>c;e--)b=prevNote(b);return b}function prevHalfStep(a){a--;a<MIN_HALF_STEP&&(a=MIN_HALF_STEP);return a}function nextHalfStep(a){a++;a>MAX_HALF_STEP&&(a=MAX_HALF_STEP);return a}
function getNotesFromSemiTones(a,c){var b=DEFAULT_SCALE_NOTES;a=a.toUpperCase();if(isCorrectNote(a)&&isCorrectSemitonesSum(c)){var b=[],e=a;b.push(e);for(var f=0;f<c.length;f++){for(var d=1;d<=c[f];d++)e=nextNote(e);b.push(e)}b.pop()}return b}function getSemiTonesPatternForString(a,c,b){for(var e=[],f=0,d=a.indexOf(b);0>d;)b=nextNote(b),d=a.indexOf(b),f++;e.push(f);for(a=d;a<c.length;a++)e.push(c[a]);for(a=0;a<d;a++)e.push(c[a]);return e}
function sliderLogVal(a,c,b){var e=0;0<a&&(c=Math.log(c),e=Math.exp(c+(Math.log(b)-c)/100*(a-0)));return e}function semiTonesPatternBoolToInt(a,c){if(isCorrectNotesShowPattern(c))for(var b=0;b<c.length;b++)c[b]=c[b]?1:0;return c}function semiTonesPatternIntToBool(a,c){var b="object"===typeof c&&Array.isArray(c);if(!b)return c;var e=c.every(function(b){return Number.isInteger(b)});if(!e)return c;var f=12==c.length;if(b&&e&&f)for(b=0;b<c.length;b++)c[b]=0===c[b]?!1:!0;return c};var audioCtx,worker,isMetronomeCanWork=!1;try{audioCtx=new AudioContext,worker=new Worker("js/worker.js"),isMetronomeCanWork=!0}catch(a){console.log(a)}
var metronome={beats:DEFAULT_METR_BEATS,beatValue:DEFAULT_METR_BEAT_VAL,volume:sliderLogVal(DEFAULT_METR_VOLUME,1,100)/100,tempo:DEFAULT_METR_TEMPO,beatNumber:0,beatsQueue:[],$playBtn:$("#"+METR_PLAY_BTN_ID),$stopBtn:$("#"+METR_STOP_BTN_ID),$volumeRange:$("#"+METR_VOLUME_RANGE_ID),$tempoRange:$("#"+METR_TEMPO_RANGE_ID),$tempoInput:$("#"+METR_TEMPO_INPUT_ID),$tempoLeftArrow:$("#"+METR_TEMPO_LEFT_ARROW_ID),$tempoRightArrow:$("#"+METR_TEMPO_RIGHT_ARROW_ID),$beatsSelect:$("#"+METR_BEATS_SELECT_ID),$beatsLeftArrow:$("#"+
METR_BEATS_LEFT_ARROW_ID),$beatsRightArrow:$("#"+METR_BEATS_RIGHT_ARROW_ID),$beatValSelect:$("#"+METR_BEAT_VAL_SELECT_ID),$beatValLeftArrow:$("#"+METR_BEAT_VAL_LEFT_ARROW_ID),$beatValRightArrow:$("#"+METR_BEAT_VAL_RIGHT_ARROW_ID),scheduleBeatFromQueue:function(){if(0<this.beatsQueue.length){var a=this.beatsQueue.shift(),c=audioCtx.createOscillator();c.type="square";var b=440;0==this.beatNumber&&(b=640);c.frequency.value=b;c.connect(this.gainNode);c.start(a.time);c.stop(a.time+50/b)}},beatsScheduler:function(){itemThis=
metronome;if(0<itemThis.beatsQueue.length){var a=itemThis.beatsQueue[itemThis.beatsQueue.length-1],c=240/itemThis.beatValue/itemThis.tempo;audioCtx.currentTime+c>=a.time&&(itemThis.beatsQueue.push({time:a.time+c,number:itemThis.beatNumber}),itemThis.scheduleBeatFromQueue(),itemThis.beatNumber=(itemThis.beatNumber+1)%itemThis.beats)}else itemThis.beatsQueue.push({time:audioCtx.currentTime,number:itemThis.beatNumber})},onPlayBtn:function(a){itemThis=a.data.itemThis;$(this).hide();itemThis.$stopBtn.show();
itemThis.beatNumber=0;worker.postMessage("startMetronomeTicking")},onStopBtn:function(a){itemThis=a.data.itemThis;$(this).hide();itemThis.$playBtn.show();worker.postMessage("stopMetronomeTicking");itemThis.beatsQueue=[]},onVolumeChange:function(a){itemThis=a.data.itemThis;a=$(this).val();a=sliderLogVal(+a,1,100);a/=100;itemThis.gainNode.gain.value=a;itemThis.volume=a},onTempoChange:function(a){itemThis=a.data.itemThis;a=$(this).val();itemThis.$tempoInput.val(a);itemThis.tempo=+a},onTempoInputChange:function(a){itemThis=
a.data.itemThis;a=$(this).val().replace(/[^,.0-9]/gim,"").replace(/[,.]+/gim,".");a=parseFloat(a);a<MIN_TEMPO?a=MIN_TEMPO:a>MAX_TEMPO&&(a=MAX_TEMPO);itemThis.tempo=a;$(this).val(a);itemThis.$tempoRange.val(a)},onTempoLeftArrow:function(a){itemThis=a.data.itemThis;a=itemThis.$tempoInput.val();a>MIN_TEMPO&&(a--,itemThis.tempo=a,itemThis.$tempoInput.val(a),itemThis.$tempoRange.val(a))},onTempoRightArrow:function(a){itemThis=a.data.itemThis;a=itemThis.$tempoInput.val();a<MAX_TEMPO&&(a++,itemThis.tempo=
a,itemThis.$tempoInput.val(a),itemThis.$tempoRange.val(a))},onBeatsChange:function(a){itemThis=a.data.itemThis;a=$(this).val();itemThis.beats=+a},onBeatsLeftArrow:function(a){itemThis=a.data.itemThis;a=itemThis.beats;a<=MIN_BEATS||(a--,itemThis.beats=a,itemThis.$beatsSelect.find("[value='"+a+"']").prop("selected",!0))},onBeatsRightArrow:function(a){itemThis=a.data.itemThis;a=itemThis.beats;a>=MAX_BEATS||(a++,itemThis.beats=a,itemThis.$beatsSelect.find("[value='"+a+"']").prop("selected",!0))},onBeatValChange:function(a){itemThis=
a.data.itemThis;a=$(this).val();itemThis.beatValue=+a},onBeatValLeftArrow:function(a){itemThis=a.data.itemThis;a=itemThis.beatValue;a<=MIN_BEAT_VAL||(a/=2,itemThis.beatValue=a,itemThis.$beatValSelect.find("[value='"+a+"']").prop("selected",!0))},onBeatValRightArrow:function(a){itemThis=a.data.itemThis;a=itemThis.beatValue;a>=MAX_BEAT_VAL||(a*=2,itemThis.beatValue=a,itemThis.$beatValSelect.find("[value='"+a+"']").prop("selected",!0))},workerTick:function(a){var c=metronome;"metronomeTick"==a.data&&
c.beatsScheduler()},init:function(){this.$stopBtn.hide();isMetronomeCanWork?(this.tempo=+this.$tempoRange.val(),this.volume=sliderLogVal(+this.$volumeRange.val(),1,100)/100,this.gainNode=audioCtx.createGain(),this.gainNode.gain.value=this.volume,this.gainNode.connect(audioCtx.destination),worker.onmessage=this.workerTick,this.$tempoInput.val(this.tempo),this.beats=this.$beatsSelect.val(),this.beatValue=this.$beatValSelect.val(),this.$playBtn.click({itemThis:this},this.onPlayBtn),this.$stopBtn.click({itemThis:this},
this.onStopBtn),this.$volumeRange.change({itemThis:this},this.onVolumeChange),this.$volumeRange.on("input",{itemThis:this},this.onVolumeChange),this.$tempoRange.change({itemThis:this},this.onTempoChange),this.$tempoRange.on("input",{itemThis:this},this.onTempoChange),this.$tempoInput.change({itemThis:this},this.onTempoInputChange),this.$tempoLeftArrow.click({itemThis:this},this.onTempoLeftArrow),this.$tempoRightArrow.click({itemThis:this},this.onTempoRightArrow),this.$beatsSelect.change({itemThis:this},
this.onBeatsChange),this.$beatsLeftArrow.click({itemThis:this},this.onBeatsLeftArrow),this.$beatsRightArrow.click({itemThis:this},this.onBeatsRightArrow),this.$beatValSelect.change({itemThis:this},this.onBeatValChange),this.$beatValLeftArrow.click({itemThis:this},this.onBeatValLeftArrow),this.$beatValRightArrow.click({itemThis:this},this.onBeatValRightArrow)):$("#"+METRONOME_DISABLED_ID).show(0)}};var defaultScaleItemOptions={scale:"major",root:"C",tuning:"standart_e",halfStep:0,stringsTunes:DEFAULT_STRING_TUNES,stringsNumber:6,isTriadMode:!1,normalNotesShowPattern:DEFAULT_NOTES_SHOW_PATTERN,triadsNotesShowPattern:DEFAULT_TRIADS_SHOW_PATTERN,boxFirstFret:-1};
function getDefaultScaleOptionsFromCookie(){if(void 0!==Cookies.getJSON("defaultScaleOptions")){var a=Cookies.getJSON("defaultScaleOptions");void 0!==a.scale&&isCorrectScale(a.scale)&&(defaultScaleItemOptions.scale=a.scale);void 0!==a.root&&isCorrectNote(a.root)&&(defaultScaleItemOptions.root=a.root);void 0!==a.tuning&&isCorrectTuning(a.tuning)&&(defaultScaleItemOptions.tuning=a.tuning);void 0!==a.halfStep&&isCorrectHalfStep(a.halfStep)&&(defaultScaleItemOptions.halfStep=+a.halfStep);void 0!==a.stringsTunes&&
isCorrectTuningNotes(a.stringsTunes)&&(defaultScaleItemOptions.stringsTunes=a.stringsTunes);void 0!==a.stringsNumber&&isCorrectStringsNumber(a.stringsNumber)&&(defaultScaleItemOptions.stringsNumber=+a.stringsNumber);void 0!==a.isTriadMode&&"boolean"===typeof a.isTriadMode&&(defaultScaleItemOptions.isTriadMode=a.isTriadMode);void 0!==a.normalNotesShowPattern&&isCorrectNotesShowPattern(a.normalNotesShowPattern)&&(defaultScaleItemOptions.normalNotesShowPattern=a.normalNotesShowPattern);void 0!==a.triadsNotesShowPattern&&
isCorrectNotesShowPattern(a.triadsNotesShowPattern)&&(defaultScaleItemOptions.triadsNotesShowPattern=a.triadsNotesShowPattern);void 0!==a.boxFirstFret&&isCorrectBoxFret(a.boxFirstFret)&&(defaultScaleItemOptions.boxFirstFret=a.boxFirstFret)}}
function ScalesItem(a,c){this.type="scales";this.id=a;this.scale="major";this.root="C";this.semiTones=DEFAULT_SCALE_SEMITONES;this.scaleNotes=DEFAULT_SCALE_NOTES;this.tuning="standart_e";this.halfStep=0;this.stringsNumber=3;this.stringsTunes=DEFAULT_STRING_TUNES;this.isTriadMode=!1;this.boxFirstFret=-1;this.normalNotesShowPattern=DEFAULT_NOTES_SHOW_PATTERN;this.triadsNotesShowPattern=DEFAULT_TRIADS_SHOW_PATTERN;this.notesBlocks=[];this.putNotesOnString=function(b){var a=this.calculateNotesBoxSize(b),
c=this.getTuneForString(b),d=getSemiTonesPatternForString(this.scaleNotes,this.semiTones,c),g=$(this.notesBlocks[b]);g.toggleClass(HIDDEN_NOTE_CLASS,!0);g.toggleClass(TRANSPARENT_NOTE_CLASS,!1);for(var m=d.shift(),c=nextNoteAfterSemiTones(c,m),h=0;m<g.length;){var n=$(this.notesBlocks[b][m]);n.toggleClass(HIDDEN_NOTE_CLASS,!1);var l=this.scaleNotes.indexOf(c),p,k=m>=this.boxFirstFret&&m<=this.boxFirstFret+a||-1==this.boxFirstFret;this.isTriadMode?(p=!this.triadsNotesShowPattern[l],n.text(l+1)):(p=
!this.normalNotesShowPattern[l],n.text(c));!p&&k||n.toggleClass(TRANSPARENT_NOTE_CLASS,!0);l=c==this.root;n.toggleClass(NORMAL_NOTE_CLASS,!l).toggleClass(HIGHLIGHTED_NOTE_CLASS,l);m+=d[h];c=nextNoteAfterSemiTones(c,d[h]);h=++h%d.length}};this.putNotesOnAllStrings=function(){for(var b=0;b<this.stringsNumber;b++)this.putNotesOnString(b)};this.putNotesOnNearStrings=function(b){0==b?this.putNotesOnString(1):b==this.stringsNumber?this.putNotesOnString(b-1):(this.putNotesOnString(b-1),this.putNotesOnString(b+
1))};this.calculateNotesBoxSize=function(b,a){a||(a=this.boxFirstFret);var e=0;if(0<b)for(var c=this.getTuneForString(b-1),g=this.getTuneForString(b),c=nextNoteAfterSemiTones(c,a),g=nextNoteAfterSemiTones(g,a);g!=c;)g=nextNote(g),g!=c&&e++;else e=4;return e};this.calculateNotesBoxSizeForAllStrings=function(b){for(var a=0,c=0;c<this.stringsNumber;c++){var d=this.calculateNotesBoxSize(c,b);d>a&&(a=d)}return a};this.isBoxFit=function(b,a){return b+a<=FRETS_NUMBER};this.incStringsNumber=function(){this.stringsNumber++;
this.$stringsNumberBlock.text(""+this.stringsNumber)};this.decStringsNumber=function(){this.stringsNumber--;this.$stringsNumberBlock.text(""+this.stringsNumber)};this.getTuneForString=function(b){return this.stringsTunes[b%this.stringsTunes.length]};this.addString=function(b){var a=this.getTuneForString(b),c=$("."+STRINGS_OPTIONS_BLOCK_CLASS,this.$itemBlock).append(STRING_TUNE_BLOCK_TMPL()).children().last();$("."+STRING_TUNE_SELECT_CLASS+" :contains('"+a+"')",c).prop("selected",!0);for(var a={currentStringNumber:b+
1},d=$("."+NULL_VER_FRET_CLASS+", ."+VER_FRET_INNER_CLASS,this.$fretboardBlock),g,m,h=0;h<d.length;h++)g=$(STRING_FRET_TMPL(a)).appendTo(d[h]),g=$("."+NOTE_CLASS,g)[0],void 0===this.notesBlocks[b]&&(this.notesBlocks[b]=[]),this.notesBlocks[b][h]=g,0==b&&(g=1==h||3==h||5==h||7==h||9==h||15==h||17==h||19==h||21==h,m=12==h||24==h,g?($(d[h]).append(STRING_FRET_MARK_TMPL()),$(FRET_DOT_TMPL()).insertAfter(d[h])):m&&($(d[h]).append(STRING_DOUBLE_FRET_MARK_TMPL()),$(FRET_DOUBLE_DOT_TMPL()).insertAfter(d[h])));
this.putNotesOnString(b);$("."+STRING_TUNE_SELECT_CLASS,c).change({itemThis:this},this.onStringTuneChange);$("."+LEFT_ARROW_CLASS,c).click({itemThis:this},this.onLeftArrowTuneClick);$("."+RIGHT_ARROW_CLASS,c).click({itemThis:this},this.onRightArrowTuneClick)};this.delLastString=function(){$("."+STRING_TUNE_BLOCK_CLASS,this.$itemBlock).last().remove();for(var b=$("."+NULL_VER_FRET_CLASS+", ."+VER_FRET_CLASS,this.$fretboardBlock),a=0;a<b.length;a++)$("."+HOR_FRET_CLASS,$(b[a])).last().remove()};this.selectCurrentStringsTunes=
function(){for(var a=$("."+STRINGS_OPTIONS_BLOCK_CLASS,this.$itemBlock),c=0;c<this.stringsNumber;c++)a.find("."+STRING_TUNE_SELECT_CLASS+":eq("+c+") :contains('"+this.getTuneForString(c)+"')").prop("selected",!0)};this.selectCurrentTuning=function(){this.$itemBlock.find("."+TUNING_SELECT_CLASS+" [value='"+this.tuning+"']").prop("selected",!0)};this.selectCurrentScale=function(){$("."+SCALE_SELECT_CLASS+" [value='"+this.scale+"']",this.$itemBlock).prop("selected",!0)};this.selectCurrentHalfStep=function(){$("."+
HALF_STEP_SELECT_CLASS+" [value='"+this.halfStep+"']",this.$itemBlock).prop("selected",!0)};this.moveTuning=function(a){for(var b=0;b<this.stringsTunes.length;b++)this.stringsTunes[b]=nextNoteAfterSemiTones(this.stringsTunes[b],a)};this.changeScaleNotesBlock=function(){$("."+SCALE_NOTES_CLASS,this.$itemBlock).remove();var a=this.scaleNotes.slice();a.push(this.root);a={root:this.root,semiTones:this.semiTones,notes:a};$("."+SCALE_NOTES_BLOCK_CLASS,this.$itemBlock).append(SCALE_NOTES_TMPL(a));for(var a=
$("."+SCALE_NOTES_CLASS,this.$itemBlock).find("."+SCALE_NOTE_TEXT_CLASS),c=a.length-1,f=0;f<c;f++)if(this.isTriadMode?!this.triadsNotesShowPattern[f]:!this.normalNotesShowPattern[f]){var d=$(a[f]);d.toggleClass(TRANSPARENT_NOTE_CLASS,!0);0==f&&(d=$(a[c]),d.toggleClass(TRANSPARENT_NOTE_CLASS,!0))}$("."+SCALE_NOTES_CLASS,this.$itemBlock).on("click","."+SCALE_NOTE_CLASS,{itemThis:this},this.onScaleNoteClick)};this.selectCurrentRootNote=function(){$("."+ROOT_NOTE_CLASS+"."+SELECTED_TEXT_CLASS,this.$itemBlock).toggleClass(SELECTED_TEXT_CLASS,
!1);$("."+ROOT_NOTE_CLASS+":contains('"+this.root+"')",this.$itemBlock).first().toggleClass(SELECTED_TEXT_CLASS,!0)};this.onScaleChange=function(a){a=a.data.itemThis;var b=$(this).val().toLowerCase();isCorrectScale(b)&&(a.scale=b,a.semiTones=getScaleSemitones(b),a.scaleNotes=getNotesFromSemiTones(a.root,a.semiTones),a.putNotesOnAllStrings(),a.changeScaleNotesBlock(),changeItemJSON(a),changeURLitemsParameters())};this.onStringTuneChange=function(a){var b=a.data.itemThis,c=$("."+STRINGS_OPTIONS_BLOCK_CLASS,
a.data.itemThis.$itemBlock);a=$(this).val();c=$("."+STRING_TUNE_SELECT_CLASS,c).index(this);b.stringsTunes[c]=a;b.putNotesOnString(c);b.putNotesOnNearStrings(c);b.tuning=CUSTOM_TUNING_VALUE;b.selectCurrentTuning();changeItemJSON(b);changeURLitemsParameters()};this.onLeftArrowTuneClick=function(a){var b=a.data.itemThis;a=$("."+STRINGS_OPTIONS_BLOCK_CLASS,a.data.itemThis.$itemBlock);var c=$("."+LEFT_ARROW_CLASS,a).index(this),d=b.stringsTunes[c],d=prevNote(d);b.stringsTunes[c]=d;$("."+STRING_TUNE_SELECT_CLASS+
":eq("+c+") :contains('"+d+"')",a).prop("selected",!0);b.putNotesOnString(c);b.putNotesOnNearStrings(c);b.tuning=CUSTOM_TUNING_VALUE;b.selectCurrentTuning();changeItemJSON(b);changeURLitemsParameters()};this.onRightArrowTuneClick=function(a){var b=a.data.itemThis;a=$("."+STRINGS_OPTIONS_BLOCK_CLASS,a.data.itemThis.$itemBlock);var c=$("."+RIGHT_ARROW_CLASS,a).index(this),d=b.stringsTunes[c],d=nextNote(d);b.stringsTunes[c]=d;$("."+STRING_TUNE_SELECT_CLASS+":eq("+c+") :contains('"+d+"')",a).prop("selected",
!0);b.putNotesOnString(c);b.putNotesOnNearStrings(c);b.tuning=CUSTOM_TUNING_VALUE;b.selectCurrentTuning();changeItemJSON(b);changeURLitemsParameters()};this.onTuningChange=function(a){a=a.data.itemThis;var b=$(this).val().toLowerCase();b==CUSTOM_TUNING_VALUE?a.tuning=b:isCorrectTuning(b)&&(a.tuning=b,a.stringsTunes=getTuneNotes(b),a.moveTuning(a.halfStep),a.putNotesOnAllStrings(),a.selectCurrentStringsTunes());changeItemJSON(a);changeURLitemsParameters()};this.onHalfStepChange=function(a){a=a.data.itemThis;
var b=a.halfStep,c=$(this).val().replace(/[^-0-9]/gim,""),c=+c;a.halfStep=c;a.moveTuning(c-b);a.selectCurrentStringsTunes();a.putNotesOnAllStrings();changeItemJSON(a);changeURLitemsParameters()};this.onLeftArrowHalfStepClick=function(a){a=a.data.itemThis;var b=a.halfStep;b!=-MAX_HALF_STEP&&(b=prevHalfStep(b),a.halfStep=b,a.moveTuning(-1),a.selectCurrentStringsTunes(),a.putNotesOnAllStrings(),a.selectCurrentHalfStep(),changeItemJSON(a),changeURLitemsParameters())};this.onRightArrowHalfStepCLick=function(a){a=
a.data.itemThis;var b=a.halfStep;b!=MAX_HALF_STEP&&(b=nextHalfStep(b),a.halfStep=b,a.moveTuning(1),a.selectCurrentStringsTunes(),a.putNotesOnAllStrings(),a.selectCurrentHalfStep(),changeItemJSON(a),changeURLitemsParameters())};this.onRootNoteChange=function(a){a=a.data.itemThis;var b=$(this).text();isCorrectNote(b)&&(a.root=b.toUpperCase(),a.selectCurrentRootNote(),a.scaleNotes=getNotesFromSemiTones(a.root,a.semiTones),a.changeScaleNotesBlock(),a.putNotesOnAllStrings(),changeItemJSON(a),changeURLitemsParameters())};
this.onScaleNoteClick=function(a){a=a.data.itemThis;var b=$("."+SCALE_NOTE_CLASS,a.$itemBlock).index(this),b=b%a.scaleNotes.length,c;a.isTriadMode?(c=!a.triadsNotesShowPattern[b],a.triadsNotesShowPattern[b]=c):(c=!a.normalNotesShowPattern[b],a.normalNotesShowPattern[b]=c);0==b?(b=$("."+SCALE_NOTE_CLASS,a.$itemBlock).last().find("."+SCALE_NOTE_TEXT_CLASS),b.toggleClass(TRANSPARENT_NOTE_CLASS,!c),b=$("."+SCALE_NOTE_CLASS,a.$itemBlock).first().find("."+SCALE_NOTE_TEXT_CLASS)):b=$(this).find("."+SCALE_NOTE_TEXT_CLASS);
b.toggleClass(TRANSPARENT_NOTE_CLASS,!c);a.putNotesOnAllStrings();changeItemJSON(a);changeURLitemsParameters()};this.onAddStringButton=function(a){a=a.data.itemThis;var b=a.stringsNumber;b<MAX_STRINGS_NUMBER&&(a.addString(b),a.incStringsNumber(),changeItemJSON(a),changeURLitemsParameters())};this.onDelStringButton=function(a){a=a.data.itemThis;a.stringsNumber>MIN_STRINGS_NUMBER&&(a.notesBlocks.pop(),a.delLastString(),a.decStringsNumber(),changeItemJSON(a),changeURLitemsParameters())};this.onCloseButton=
function(a){a=a.data.itemThis;a.$itemBlock.hide(200,function(){$(this).remove()});deleteItem(a.id)};this.onSetDefaultButton=function(a){a=a.data.itemThis;defaultScaleItemOptions.scale=a.scale;defaultScaleItemOptions.root=a.root;defaultScaleItemOptions.semiTones=a.semiTones;defaultScaleItemOptions.tuning=a.tuning;defaultScaleItemOptions.halfStep=a.halfStep;defaultScaleItemOptions.stringsTunes=a.stringsTunes;defaultScaleItemOptions.stringsNumber=a.stringsNumber;defaultScaleItemOptions.isTriadMode=a.isTriadMode;
defaultScaleItemOptions.boxFirstFret=a.boxFirstFret;Cookies.set("defaultScaleOptions",defaultScaleItemOptions,{expires:DEFAULT_SCALE_OPTIONS_EXPIRE_DAYS})};this.onTriadsCheckboxClick=function(a){a=a.data.itemThis;a.isTriadMode?(a.isTriadMode=!1,a.$triadsCheckbox.hide(0),a.$triadsCheckboxEmpty.show(0)):(a.isTriadMode=!0,a.$triadsCheckboxEmpty.hide(0),a.$triadsCheckbox.show(0));a.changeScaleNotesBlock();a.putNotesOnAllStrings();changeItemJSON(a);changeURLitemsParameters()};this.onFretClick=function(a){a=
a.data.itemThis;var b=a.$fretboardBlock.find("."+NULL_VER_FRET_CLASS+", ."+VER_FRET_INNER_CLASS).index(this);if(a.boxFirstFret==b)a.boxFirstFret=-1;else{var c=a.calculateNotesBoxSizeForAllStrings(b);a.isBoxFit(b,c)&&(a.boxFirstFret=b)}a.putNotesOnAllStrings();changeItemJSON(a);changeURLitemsParameters()};this.onFretHoverIn=function(a){var b=a.data.itemThis;a=b.$fretboardBlock.find("."+NULL_VER_FRET_CLASS+", ."+VER_FRET_INNER_CLASS).index(this);var c=b.calculateNotesBoxSizeForAllStrings(a);if(b.isBoxFit(a,
c))for(var b=$("."+FRET_HOVER_CLASS,b.$fretboardBlock),d=0;d<=c;d++){var g=FRET_HOVER_ACTIVE_CENTER_CLASS;0==d?g=FRET_HOVER_ACTIVE_START_CLASS:d==c&&(g=FRET_HOVER_ACTIVE_END_CLASS);$(b[a+d]).toggleClass(g,!0)}};this.onFretHoverOut=function(a){a.data.itemThis.$fretboardBlock.find("."+FRET_HOVER_CLASS).toggleClass(FRET_HOVER_ACTIVE_START_CLASS,!1).toggleClass(FRET_HOVER_ACTIVE_CENTER_CLASS,!1).toggleClass(FRET_HOVER_ACTIVE_END_CLASS,!1)};this.initStrings=function(){for(var a=0;a<FRETS_NUMBER;a++)this.$fretboardBlock.children().last().before(STRING_VER_FRET_TMPL());
for(a=0;a<this.stringsNumber;a++)this.addString(a),this.$stringsNumberBlock.text(""+this.stringsNumber);this.selectCurrentStringsTunes()};this.readDefaultScaleItemOptions=function(){this.scale=defaultScaleItemOptions.scale;this.root=defaultScaleItemOptions.root;this.semiTones=getScaleSemitones(this.scale);this.scaleNotes=getNotesFromSemiTones(this.root,this.semiTones);this.tuning=defaultScaleItemOptions.tuning;this.halfStep=defaultScaleItemOptions.halfStep;this.stringsTunes=defaultScaleItemOptions.stringsTunes;
var a=defaultScaleItemOptions.stringsNumber;a<MIN_STRINGS_NUMBER&&(a=MIN_STRINGS_NUMBER);this.stringsNumber=a;this.isTriadMode=defaultScaleItemOptions.isTriadMode;this.normalNotesShowPattern=defaultScaleItemOptions.normalNotesShowPattern;this.triadsNotesShowPattern=defaultScaleItemOptions.triadsNotesShowPattern;this.boxFirstFret=defaultScaleItemOptions.boxFirstFret};this.isCorrectScalesJSONfields=function(a){var b=!1,c=!0,d=[];try{d=JSON.parse(a,semiTonesPatternIntToBool)}catch(g){c=!1}c&&(b=11==
d.length&&"scales"==d[0]&&isCorrectScale(d[1])&&isCorrectNote(d[2])&&isCorrectTuning(d[3])&&isCorrectHalfStep(d[4])&&isCorrectStringsNumber(d[5])&&isCorrectTuningNotes(d[6])&&typeof("boolean"===d[7])&&isCorrectNotesShowPattern(d[8])&&isCorrectNotesShowPattern(d[9])&&isCorrectBoxFret(d[10]));return b};this.getItemJSON=function(){var a=[this.type,this.scale,this.root,this.tuning,this.halfStep,this.stringsNumber,this.stringsTunes,this.isTriadMode,this.normalNotesShowPattern.slice(),this.triadsNotesShowPattern.slice(),
this.boxFirstFret];return JSON.stringify(a,semiTonesPatternBoolToInt)};this.setItemsFieldFromJSON=function(a){this.isCorrectScalesJSONfields(a)?(a=JSON.parse(a,semiTonesPatternIntToBool),this.type=a[0],this.scale=a[1],this.root=a[2],this.tuning=a[3],this.halfStep=a[4],this.stringsNumber=a[5],this.stringsTunes=a[6],this.isTriadMode=a[7],this.normalNotesShowPattern=a[8],this.triadsNotesShowPattern=a[9],this.semiTones=getScaleSemitones(this.scale),this.scaleNotes=getNotesFromSemiTones(this.root,this.semiTones),
this.boxFirstFret=a[10]):(this.readDefaultScaleItemOptions(),changeItemJSON(this),changeURLitemsParameters())};this.initTriadsCheckbox=function(){this.$triadsCheckbox=$("."+TRIADS_CHECKBOX_CLASS,this.$itemBlock);this.$triadsCheckboxEmpty=$("."+TRIADS_CHECKBOX_EMPTY_CLASS,this.$itemBlock);this.isTriadMode?this.$triadsCheckboxEmpty.hide(0):this.$triadsCheckbox.hide(0);this.$triadsCheckbox.click({itemThis:this},this.onTriadsCheckboxClick);this.$triadsCheckboxEmpty.click({itemThis:this},this.onTriadsCheckboxClick)};
this.initAnimation=function(){this.$itemBlock.hide(0);this.$itemBlock.show(200)};this.init=function(){$addNewItemBtn.before(SCALES_ITEM_BLOCK_TMPL({id:this.id}));this.$itemBlock=$("#"+this.id);this.$stringsNumberBlock=$("."+STRING_NUMBER_CLASS,this.$itemBlock);this.$fretboardBlock=$("."+FRETBOARD_CLASS,this.$itemBlock);this.initAnimation();c?this.setItemsFieldFromJSON(c):this.readDefaultScaleItemOptions();this.initStrings();this.initTriadsCheckbox();this.changeScaleNotesBlock();this.selectCurrentTuning();
this.selectCurrentScale();this.selectCurrentHalfStep();this.selectCurrentRootNote();this.putNotesOnAllStrings();$("."+SCALE_SELECT_CLASS,this.$itemBlock).change({itemThis:this},this.onScaleChange);$("."+TUNING_SELECT_CLASS,this.$itemBlock).change({itemThis:this},this.onTuningChange);$("."+HALF_STEP_SELECT_CLASS,this.$itemBlock).change({itemThis:this},this.onHalfStepChange);this.$itemBlock.find("."+HALF_STEP_BLOCK_CLASS).find("."+LEFT_ARROW_CLASS).click({itemThis:this},this.onLeftArrowHalfStepClick);
this.$itemBlock.find("."+HALF_STEP_BLOCK_CLASS).find("."+RIGHT_ARROW_CLASS).click({itemThis:this},this.onRightArrowHalfStepCLick);$("."+SCALE_NOTES_BLOCK_CLASS,this.$itemBlock).on("click","."+ROOT_NOTE_CLASS,{itemThis:this},this.onRootNoteChange);$("."+ADD_STRING_BTN_CLASS,this.$itemBlock).click({itemThis:this},this.onAddStringButton);$("."+DEL_STRING_BTN_CLASS,this.$itemBlock).click({itemThis:this},this.onDelStringButton);$("."+CLOSE_BTN_CLASS,this.$itemBlock).click({itemThis:this},this.onCloseButton);
$("."+SET_DEFAULT_BTN_CLASS,this.$itemBlock).click({itemThis:this},this.onSetDefaultButton);this.$fretboardBlock.on("click","."+NULL_VER_FRET_CLASS+", ."+VER_FRET_INNER_CLASS,{itemThis:this},this.onFretClick);this.$fretboardBlock.on("mouseenter","."+NULL_VER_FRET_CLASS+", ."+VER_FRET_INNER_CLASS,{itemThis:this},this.onFretHoverIn);this.$fretboardBlock.on("mouseleave","."+NULL_VER_FRET_CLASS+", ."+VER_FRET_INNER_CLASS,{itemThis:this},this.onFretHoverOut)};this.init()};var menuItems=[],usedIDs=[],itemsJSONs=[];function getIDforNewItem(){for(var a=0;0<=usedIDs.indexOf("menuItem"+a);)a++;return"menuItem"+a}function createNewItem(){var a=getIDforNewItem();menuItems.length<MAX_ITEMS_NUMBER?(menuItems.push(new ScalesItem(a)),usedIDs.push(a),itemsJSONs.push(menuItems[menuItems.length-1].getItemJSON()),changeURLitemsParameters()):$addNewItemBtn.hide(200)}
function createItemsFromURLparameters(){for(var a=0;a<itemsJSONs.length&&a<MAX_ITEMS_NUMBER;a++){var c=getIDforNewItem();menuItems.push(new ScalesItem(c,itemsJSONs[a]));usedIDs.push(c)}menuItems.length>=MAX_ITEMS_NUMBER&&$addNewItemBtn.hide(200)}function deleteItem(a){menuItems.length==MAX_ITEMS_NUMBER&&$addNewItemBtn.show(200);for(var c=0;c<menuItems.length;c++)menuItems[c].id===a&&(menuItems.splice(c,1),itemsJSONs.splice(c,1),usedIDs.splice(usedIDs.indexOf(a),1),changeURLitemsParameters())}
function changeURLitemsParameters(){for(var a="?",c=0;c<itemsJSONs.length;c++){var b=btoa(itemsJSONs[c]),a=a+("i"+c+"="+b);c<itemsJSONs.length-1&&(a+="&")}history.replaceState({},"",a)}function readURLitemsParameters(){var a=window.location.href,c=a.indexOf("?"),b=[];if(-1!=c)for(var a=a.slice(c+1).split("&"),e=0;e<a.length;e++)if(c=a[e].indexOf("="),-1!=c){c=a[e].slice(c+1);c=decodeURI(c);try{c=atob(c),b.push(c)}catch(f){console.log(PARAMS_ATOB_ERROR_MSG+"\n"+f)}}itemsJSONs=b}
function changeItemJSON(a){var c=$("."+ITEM_CLASS).index(a.$itemBlock);itemsJSONs[c]=a.getItemJSON()}function itemsInit(){getDefaultScaleOptionsFromCookie();readURLitemsParameters();0==itemsJSONs.length?createNewItem():createItemsFromURLparameters()}var $addNewItemBtn=$("#"+ADD_NEW_ITEM_BTN_ID);$addNewItemBtn.click(createNewItem);metronome.init();itemsInit();
